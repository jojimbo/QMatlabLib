classdef MissingDataTreatmentRuleFactory
    %MISSINGDATATREATMENTRULEFACTORY Summary of this class goes here
    %   Detailed explanation goes here
    
    properties(Access=pr
    end
    
    methods
        function obj = MissingDataTreatmentRuleFactory()
            cm = prursg.Configuration.ConfigurationManager();
            obj.daoMap = cm.HistoricalDataDaoMap;
        end
    
        function dao = Create(obj, name)
            dao = [];
            if isempty(obj.daoMap)
                ex = MException('HistoricalDataDaoFactory:Create', 'Internal map is empty.');
                throw ex;
            end
            
            if ~isKey(obj.daoMap, lower(name))
                ex = MException('HistoricalDataDaoFactory:Create', ['The given name(' name ') is not found in the internal map.']);                
                throw ex;
            end
            
            className = obj.daoMap(lower(name));
            
            expression = ['dao = ' className ';'];
            eval(expression);            
        end
    end
    
end

